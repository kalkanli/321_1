SELECT * FROM (SELECT   Tracks.circuit_type, Teams.short_name, count(lap_recorder)  as lap_recorder2 FROM Teams,Tracks WHERE ( Teams.driver_one= Tracks.lap_recorder OR  Teams.driver_two=Tracks.lap_recorder ) AND Tracks.circuit_type is 'street' GROUP by Teams.team_id , Tracks.circuit_type)  WHERE lap_recorder2 IN
( SELECT  max(lap_recorder1) FROM (SELECT    Tracks.circuit_type, Teams.short_name, count(lap_recorder)  as lap_recorder1 FROM Teams,Tracks WHERE ( Teams.driver_one= Tracks.lap_recorder OR  Teams.driver_two=Tracks.lap_recorder ) AND Tracks.circuit_type is 'street' GROUP by Teams.team_id , Tracks.circuit_type ORDER BY circuit_type,lap_recorder1  DESC) )
UNION
SELECT * FROM (SELECT   Tracks.circuit_type, Teams.short_name, count(lap_recorder)  as lap_recorder2 FROM Teams,Tracks WHERE ( Teams.driver_one= Tracks.lap_recorder OR  Teams.driver_two=Tracks.lap_recorder ) AND Tracks.circuit_type is 'race' GROUP by Teams.team_id , Tracks.circuit_type)  WHERE lap_recorder2 IN
( SELECT  max(lap_recorder1) FROM (SELECT    Tracks.circuit_type, Teams.short_name, count(lap_recorder)  as lap_recorder1 FROM Teams,Tracks WHERE ( Teams.driver_one= Tracks.lap_recorder OR  Teams.driver_two=Tracks.lap_recorder ) AND Tracks.circuit_type is 'race' GROUP by Teams.team_id , Tracks.circuit_type ORDER BY circuit_type,lap_recorder1  DESC) )
